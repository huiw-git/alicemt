---
title: Persisting Records in XML Format
ms.custom: na
ms.date: 07/11/2016
ms.reviewer: na
ms.suite: na
ms.tgt_pltfrm: na
ms.topic: article
ms.assetid: f3113ec4-ae31-428f-89c6-bc1024f128ea
manager: sonalm
translation.priority.ht: 
  - de-de
  - es-es
  - fr-fr
  - it-it
  - ja-jp
  - ko-kr
  - pt-br
  - ru-ru
  - zh-cn
  - zh-tw
---
# Persisting Records in XML Format
<?xml version="1.0" encoding="utf-8"?>
<developerConceptualDocument xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://ddue.schemas.microsoft.com/authoring/2003/5 http://dduestorage.blob.core.windows.net/ddueschema/developer.xsd">
  <introduction>
    <para>Like ADTG format, <legacyBold>Recordset</legacyBold> persistence in XML format is implemented with the Microsoft OLE DB Persistence Provider. This provider generates a forward-only, read-only rowset from a saved XML file or stream that contains the schema information generated by ADO. Similarly, it can take an ADO <legacyBold>Recordset</legacyBold>, generate XML, and save it to a file or any object that implements the COM <legacyBold>IStream</legacyBold> interface. (In fact, a file is just another example of an object that supports <legacyBold>IStream</legacyBold>.) For versions 2.5 and later, ADO relies on the Microsoft XML Parser (MSXML) to load the XML into the <legacyBold>Recordset</legacyBold>; therefore msxml.dll is required.</para>
    <alert class="note">
      <para>Some limitations apply when saving hierarchical <legacyBold>Recordsets</legacyBold> (data shapes) to XML format. You cannot save to XML if the hierarchical <legacyBold>Recordset</legacyBold> contains pending updates, and you cannot save a parameterized hierarchical <legacyBold>Recordset</legacyBold>. For more information, see <link xlink:href="d01aeb4d-4e43-450b-b3f2-0c27eaaf9f86">Persisting Filtered and Hierarchical Recordsets</link>.</para>
    </alert>
    <para>The easiest way to persist data into XML and load it back again through ADO is with the <legacyBold>Save</legacyBold> and <legacyBold>Open</legacyBold> methods, respectively. The following ADO code example demonstrates saving the data in the <legacyBold>Titles</legacyBold> table to a file that is named titles.sav.</para>
    <code>Dim rs as new Recordset
Dim rs2 as new Recordset
Dim c as new Connection
Dim s as new Stream

' Query the Titles table.
c.Open "provider=sqloledb;data source=MySQLServer;initial catalog=pubs;Integrated Security='SSPI'"
rs.cursorlocation = adUseClient
rs.Open "select * from titles", c, adOpenStatic

' Save to the file in the XML format. Note that if you don't specify 
' adPersistXML, a binary format (ADTG) will be used by default.
rs.Save "titles.sav", adPersistXML

' Save the recordset into the ADO Stream object.
rs.save s, adPersistXML
rs.Close
c.Close

set rs = nothing

' Reopen the file.
rs.Open "titles.sav",,,,adCmdFile
' Open the Stream back into a Recordset.
rs2.open s</code>
    <para>ADO always persists the entire <legacyBold>Recordset</legacyBold> object. If you want to persist a subset of rows of the <legacyBold>Recordset</legacyBold> object, use the <legacyBold>Filter</legacyBold> method to narrow down the rows or change your selection clause. However, you must open a <legacyBold>Recordset</legacyBold> object with a client-side cursor (<legacyBold>CursorLocation</legacyBold> = <legacyBold>adUseClient</legacyBold>) to use the <legacyBold>Filter</legacyBold> method for saving a subset of rows. For example, to retrieve titles that start with the letter "b," you can apply a filter to an open <legacyBold>Recordset</legacyBold> object:</para>
    <code>rs.Filter "title_id like 'B*'"
rs.Save "btitles.sav", adPersistXML</code>
    <para>ADO always uses the Client Cursor Engine rowset to produce a scrollable, bookmarkable <legacyBold>Recordset</legacyBold> object on top of the forward-only data generated by the Persistence Provider.</para>
    <para>This section contains the following topics.</para>
    <list class="bullet">
      <listItem>
        <para>
          <link xlink:href="6e146738-ac4d-47bb-b6cd-d87b2260aead">XML Persistence Format</link>
        </para>
      </listItem>
      <listItem>
        <para>
          <link xlink:href="efff5569-db52-451d-a039-2e74870534da">Namespaces</link>
        </para>
      </listItem>
      <listItem>
        <para>
          <link xlink:href="4ac6e524-2c92-48e8-b871-0a4b5c8fda18">Schema Section</link>
        </para>
      </listItem>
      <listItem>
        <para>
          <link xlink:href="43dc42a8-7057-48e6-93d6-880d5c5c51a4">Data Section</link>
        </para>
      </listItem>
      <listItem>
        <para>
          <link xlink:href="5d4b11c4-c94f-4910-b99b-5b9abc50d791">Hierarchical Recordsets in XML</link>
        </para>
      </listItem>
      <listItem>
        <para>
          <link xlink:href="52f8e379-812a-4db8-9210-94458926301c">Recordset Dynamic Properties in XML</link>
        </para>
      </listItem>
      <listItem>
        <para>
          <link xlink:href="1a46196e-839f-4734-a59e-2c64609ffb9e">XSLT Transformations</link>
        </para>
      </listItem>
      <listItem>
        <para>
          <link xlink:href="4d20fd28-aaf8-4232-83ce-f9d1e5f93dae">Saving to the XML DOM Object</link>
        </para>
      </listItem>
      <listItem>
        <para>
          <link xlink:href="fadbd38e-6e7b-4b81-96ea-85169c664374">XML Security Considerations</link>
        </para>
      </listItem>
      <listItem>
        <para>
          <link xlink:href="353d569a-043a-4397-9ee6-564c4af8d5f6">XML Recordset Persistence Scenario</link> </para>
      </listItem>
    </list>
  </introduction>
  <relatedTopics />
</developerConceptualDocument>