---
title: Appendix F: ODBC Cursor Library
ms.custom: na
ms.date: 07/12/2016
ms.prod: sql-non-specified
ms.reviewer: na
ms.suite: na
ms.technology: 
  - drivers
ms.tgt_pltfrm: na
ms.topic: article
ms.assetid: a03084df-4e48-48ef-917d-4a3fae48a605
manager: jhubbard
translation.priority.ht: 
  - en-gb
---
# Appendix F: ODBC Cursor Library
<?xml version="1.0" encoding="utf-8"?>
<developerReferenceWithoutSyntaxDocument xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://ddue.schemas.microsoft.com/authoring/2003/5 http://dduestorage.blob.core.windows.net/ddueschema/developer.xsd">
  <introduction>
    <alert class="important">
      <para>This feature will be removed in a future version of Windows. Avoid using this feature in new development work and plan to modify applications that currently use this feature. Microsoft recommends using the driver's cursor functionality. </para>
    </alert>
    <para>The ODBC cursor library (Odbccr32.dll) supports block scrollable cursors for any driver that complies with the Level 1 API conformance level and can be redistributed by developers with their applications or drivers. The cursor library also supports positioned update and delete statements for result sets generated by <legacyBold>SELECT</legacyBold> statements. Although it supports only static and forward-only cursors, the cursor library satisfies the needs of many applications. Furthermore, it can provide good performance, especially for small-sized to medium-sized result sets, and for applications that do not have good cursor support.</para>
  </introduction>
  <section>
    <content>
      <para>The cursor library is a dynamic-link library (DLL) that resides between the Driver Manager and the driver. When an application calls a function, the Driver Manager calls the function in the cursor library, which either executes the function or calls it in the specified driver. For a given connection, an application specifies whether the cursor library is always used, used if the driver does not support scrollable cursors, or never used.</para>
      <para>The cursor library appears as a driver to the Driver Manager. If the cursor library resides between the Driver Manager and an ODBC 2.<legacyItalic>x</legacyItalic> driver, the cursor library appears as an ODBC 2.<legacyItalic>x</legacyItalic> driver. If the cursor library resides between the Driver Manager and an ODBC 3<legacyItalic>.x</legacyItalic> driver, the cursor library appears as an ODBC 3<legacyItalic>.x</legacyItalic> driver. The behavior exhibited by the cursor library depends upon the version of the driver it is working with, with the exception of binding offsets, which is supported for both ODBC 2.<legacyItalic>x</legacyItalic> and ODBC 3.<legacyItalic>x</legacyItalic> drivers.</para>
      <para>To implement block cursors in <legacyBold>SQLFetch</legacyBold> and <legacyBold>SQLFetchScroll</legacyBold>, the cursor library repeatedly calls <legacyBold>SQLFetch</legacyBold> in the driver. To implement scrolling, it caches the data it has retrieved in memory and in disk files. When an application requests a new rowset, the cursor library retrieves it as necessary from the driver or the cache.</para>
      <para>To implement positioned update and delete statements, the cursor library constructs an <legacyBold>UPDATE</legacyBold> or <legacyBold>DELETE</legacyBold> statement with a <legacyBold>WHERE</legacyBold> clause that specifies the cached value of each bound column in the row. When it executes a positioned update statement, the cursor library updates its cache from the values in the rowset buffers.</para>
      <para>For more information about the ODBC cursor library, see the following sections of this appendix:  </para>
      <list class="bullet">
        <listItem>
          <para>
            <legacyLink xlink:href="9653f2f8-ccfc-4220-99ef-601dc0fa641c">Using the ODBC Cursor Library</legacyLink>
          </para>
        </listItem>
        <listItem>
          <para>
            <legacyLink xlink:href="1d64f309-2a6e-4ad1-a6b5-e81145549c56">Executing Positioned Update and Delete Statements</legacyLink>
          </para>
        </listItem>
        <listItem>
          <para>
            <legacyLink xlink:href="958a179c-97d9-4717-8d06-d33b715a9773">Cursor Library Code Example</legacyLink>
          </para>
        </listItem>
        <listItem>
          <para>
            <legacyLink xlink:href="7ec14b9c-69b8-4c6e-838a-88d1ebdc8725">Implementation Notes</legacyLink> </para>
        </listItem>
        <listItem>
          <para>
            <legacyLink xlink:href="9713480e-8744-4f37-a630-20871590d4a1">ODBC Cursor Library Error Codes</legacyLink>
          </para>
        </listItem>
      </list>
    </content>
  </section>
  <relatedTopics />
</developerReferenceWithoutSyntaxDocument>